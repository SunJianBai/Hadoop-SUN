

<div style="text-align: center;">

![北京理工大学校徽](https://raw.githubusercontent.com/SunJianBai/pictures/main/img/202509151957254.png)

# 大数据系统开发实践实验报告

<br>
<br>
<br>

<div style="display: grid; justify-content: center; align-items: flex-start;">
### 题　　目： <u>基于Hadoop的分布式倒排索引系统实现</u>

### 学　　院： <u>计算机学院</u>

### 专业名称： <u>计算机科学与技术</u>

### 小组成员： <u>孙健柏 徐文博 张元宏 宫可鑫 陈春林 于希</u>

### 任课教师： <u>冯恺宇</u>

### 日　　期： <u>2025年9月13日</u>

</div>

<br>
<br>

</div>

<div style="page-break-after: always;"></div>

## 目录

[toc]





- 小组分工

| 姓名 | 学号 | 分工内容 |
|------|------|----------|
| 孙健柏 | 1320240204 | 配置完全分布环境，编写MapReduce代码，编写WebUI代码 |
| 徐文博 | 1320240207 | 编写查询代码，执行伪分布运行，参与完全分布 |
| 张元宏 | 1120231602 | 参与完全分布，编写文档 |
| 宫可鑫 | 1120232267 | 配置完全分布环境，参与完全分布 |
| 陈春林 | 1120231862 | 执行伪分布下运行 |
| 于希 | 1820231034 | 啥也没干 |

<div style="page-break-after: always;"></div>

# 1. 搜索引擎的技术方案

## 1.1 功能描述

本搜索引擎系统基于Hadoop生态系统构建，主要功能模块包括：

1. **数据预处理模块**
   - 接收原始文本数据(sentences.txt)
   - 使用Python程序将大文件分割为940个小文件
   - 将分割后的文件上传至HDFS分布式文件系统

2. **索引构建模块**
   - 使用MapReduce框架构建倒排索引
   - 实现Mapper阶段：生成〈单词:文档ID, 1〉键值对
   - 实现Combiner阶段：局部聚合相同键的值
   - 实现Reducer阶段：全局统计并生成最终倒排索引

3. **数据存储模块**
   - 设计HBase数据库表结构存储倒排索引
   - 将MapReduce处理结果直接写入HBase
   - 确保数据的高可用性和快速检索

4. **查询服务模块**
   - 提供HBase查询接口
   - 支持关键词检索并返回包含该词的所有文档
   - 开发Web可视化界面展示搜索结果

5. **系统监控模块**
   - 监控Hadoop集群运行状态
   - 记录任务执行日志和性能指标

## 1.2 技术选型

### 1.2.1 Hadoop生态系统简介

Hadoop是Apache基金会开发的开源分布式系统基础架构，具有高扩展性和容错性。本项目使用的核心组件包括：

- **HDFS**：分布式文件系统，用于存储大规模数据集
- **MapReduce**：分布式计算框架，用于并行处理大数据
- **YARN**：集群资源管理系统，负责资源调度和任务管理
- **HBase**：分布式列式数据库，用于实时读写大规模数据
- **ZooKeeper**：分布式协调服务，用于维护配置信息和命名服务

### 1.2.2 Hadoop的优势

1. **高可扩展性**：支持线性扩展，可通过增加节点提升系统处理能力
2. **高容错性**：数据自动复制多份，节点故障不影响整体服务
3. **成本效益**：可在廉价硬件上构建大规模集群
4. **成熟生态**：拥有丰富的生态系统和社区支持
5. **适合批处理**：特别适合海量数据的离线批处理任务

### 1.2.3 Hadoop的劣势

1. **实时性差**：不适合毫秒级响应的实时计算场景
2. **小文件问题**：处理大量小文件时效率较低
3. **迭代计算支持不足**：不适合需要多次迭代的机器学习算法
4. **复杂性高**：配置、维护和调试相对复杂

### 1.2.4 结论

Hadoop生态系统非常适合构建分布式倒排索引系统，其批处理能力与倒排索引的构建过程高度契合。虽然存在实时性不足等问题，但对于本项目要求的离线索引构建场景是完全适用的。

## 1.3 功能实现

### 1.3.1 初始文件切分与存储

原始数据文件`sentences.txt`大小1.43GB，包含约940万行句子。通过Python脚本将其按每10,000行分割为940个小文件，命名为file0.txt至file939.txt。

**关键技术点**：
- 使用Python标准文件IO操作进行分割
- 确保分割后的文件大小适中，避免HDFS小文件问题
- 使用HDFS命令将分割后的文件上传至分布式文件系统

### 1.3.2 MapReduce创建倒排索引

采用两阶段MapReduce作业构建倒排索引：

**第一阶段**：词频统计
- Map任务：读取输入文件，输出〈单词:文档ID, 1〉
- Combine任务：局部聚合相同键的值，减少网络传输
- Reduce任务：全局统计，输出〈单词, 文档ID:频次〉

**第二阶段**：索引构建
- 将第一阶段结果转换为倒排列表格式
- 按单词分组，生成〈单词, [文档ID1:频次1;文档ID2:频次2;...]〉

### 1.3.3 将索引存储到HBase

设计HBase表`inverted_index`存储倒排索引：

| RowKey | 列族:info |
|--------|-----------|
| 单词1  | 文档ID1:频次1, 文档ID2:频次2, ... |
| 单词2  | 文档ID3:频次3, 文档ID4:频次4, ... |

使用TableMapReduceUtil直接将MapReduce输出写入HBase表。

### 1.3.4 实现查询功能

通过HBase API实现查询接口：
- 根据输入单词获取对应的行数据
- 解析列数据获取文档列表和频次信息
- 按频次排序返回最相关文档

使用 Flask 编写一个 Web UI。通过用户友好的可视化界面进行查询。

### 1.3.5 实例分析

以查询单词"hadoop"为例：
1. 在HBase中查询RowKey为"hadoop"的行
2. 获取该行所有列的值（格式：文档ID:频次）
3. 解析并按频次排序返回结果
4. 显示：文件23（频次15）、文件156（频次12）等

## 1.4 工作计划

**第一阶段：环境准备与数据预处理**

- 搭建Hadoop伪分布式环境
- 编写文件分割脚本
- 准备测试数据集

**第二阶段：核心算法开发**

- 设计倒排索引MapReduce程序
- 实现HBase表结构和数据模型
- 开发查询接口

**第三阶段：系统测试与优化**

- 伪分布式环境功能测试
- 完全分布式环境部署与测试

**第四阶段：文档撰写与总结**

- 整理实验数据与结果
- 撰写技术报告

## 1.5 组织结构

### 1.5.1 分工架构

本项目采用分层协作的组织架构：
1. **基础设施层**：负责Hadoop集群搭建和维护
2. **数据处理层**：负责MapReduce程序开发和优化
3. **数据存储层**：负责HBase数据库设计和实现
4. **应用接口层**：负责查询功能和可视化界面开发
5. **质量保障层**：负责测试和文档工作

### 1.5.2 人员分配

- **系统架构师**（1人）：技术选型、架构设计
- **开发工程师**（2人）：编码实现、单元测试
- **测试工程师**（2人）：系统测试(伪分布与完全分布)、性能评估
- **文档工程师**（1人）：文档撰写、资料整理

## 1.6 软件质量保证

### 1.6.1 功能测试

- 验证文件分割功能正确性
- 测试MapReduce作业输出准确性
- 验证HBase数据存储和查询功能

### 1.6.2 性能测试

- 测量不同规模数据下的处理时间
- 评估集群扩展性和负载能力
- 分析系统瓶颈和优化点

### 1.6.3 安全性测试

- 验证HDFS数据安全性
- 测试HBase访问控制机制
- 检查网络通信安全性

### 1.6.4 兼容性测试

- 测试不同Hadoop版本的兼容性
- 验证跨平台运行能力

### 1.6.5 回归测试

- 建立自动化测试脚本
- 确保新功能不影响现有功能

## 1.7 软件非功能性保证

1. **性能指标**
   - 数据处理速度：≥100MB/分钟
   - 查询响应时间：≤500ms
   - 系统可用性：≥99.9%

2. **可靠性保证**
   - 数据持久化：确保数据不丢失
   - 故障恢复：支持快速故障转移和恢复

3. **可维护性**
   - 模块化设计，便于维护和扩展
   - 详细文档和注释

4. **可用性**
   - 提供简洁易用的查询接口
   - 良好的错误提示和日志记录



# 2. 倒排索引的实现

### 2.1 实验要求

倒排列表用来记录有哪些文档包含了某个单词。一般在文档集合里会有很多文档包含某个单词，每个文档会记录文档编号（DocID），单词在这个文档中出现的次数（TF）。这样与一个文档相关的信息被称做倒排索引项（Posting），包含这个单词的一系列倒排索引项形成了列表结构，这就是某个单词对应的倒排列表。下图是倒排列表的示意图。

![image-20250919155608462](https://raw.githubusercontent.com/SunJianBai/pictures/main/img/202509191556540.png)

实现文档的倒排索引，即运用MapReduce算法计算，构建一个倒排索引，将倒排索引存储在HBase中。使用i北理群中提供的`sentences.txt`数据集（解压后1.43GB），通过Python程序将大文件分割成940个小文件，上传至HDFS后使用MapReduce处理，最终实现关键词查询功能。

### 2.2 实验进度

- 9月8日-9月9日：环境准备与学习
- 9月10日：完成伪分布式环境搭建
- 9月11日-9月12日：完成MapReduce程序编写
- 9月12日-9月13日：完全分布式环境搭建与调试
- 9月14日：系统测试与优化
- 9月15日：结果分析与文档撰写

### 2.3 环境的安装与配置

#### 2.3.1 环境选择

 **系统环境**

- 操作系统：ubuntu 24.04（一台是物理机，三台是虚拟机）
- 虚拟机软件：VMware Workstation Pro 17
- JDK版本：  jdk 1.8.0_461
- Hadoop版本： hadoop-3.3.0
- HBase版本： hbase-2.4.18
- zookeeper版本： zookeeper-3.7.2

 **关键配置**

   - 配置SSH免密登录
   - 设置JAVA_HOME、HADOOP_HOME等环境变量
   - 修改Hadoop配置文件(core-site.xml, hdfs-site.xml, yarn-site.xml, mapred-site.xml)
   - 配置HBase和ZooKeeper

#### 2.3.2 伪分布环境配置

##### hadoop-env.sh

直接添加一行即可
```bash
export JAVA_HOME=/usr/local/java/jdk1.8.0_461
```

##### core-site.xml

修改原来的`<configuration></configuration>`为
因为现在是在本地模拟分布，所以使用localhost为ip地址。
```xml
<configuration>
    <property>
        <name>fs.defaultFS</name>
        <value>hdfs://localhost:9000</value>
    </property>
    <property>
        <name>hadoop.tmp.dir</name>
        <value>/usr/local/hadoop/tmp</value>
    </property>
</configuration>
```

##### hdfs-site.xml

修改原来的`<configuration></configuration>`为
```xml
<configuration>
    <property>
        <name>dfs.replication</name>
        <value>1</value>
    </property>
    <property>
        <name>dfs.namenode.name.dir</name>
        <value>file:///usr/local/hadoop/hdfs/namenode</value>
    </property>
    <property>
        <name>dfs.datanode.data.dir</name>
        <value>file:///usr/local/hadoop/hdfs/datanode</value>
    </property>
</configuration>
```

###### mapred-site.xml

修改原来的`<configuration></configuration>`为
```xml
<configuration>
    <property>
        <name>mapreduce.framework.name</name>
        <value>yarn</value>
    </property>
</configuration>

```

###### yarn-site.xml

修改原来的`<configuration></configuration>`为
```xml
<configuration>
  <property>
    <name>yarn.nodemanager.aux-services</name>
    <value>mapreduce_shuffle</value>
  </property>
  <property>
    <name>yarn.resourcemanager.hostname</name>
    <value>localhost</value>
  </property>
  <property>
		<name>yarn.application.classpath</name>
		<value>
		  $HADOOP_HOME/etc/hadoop,
		  $HADOOP_HOME/share/hadoop/common/*,
		  $HADOOP_HOME/share/hadoop/common/lib/*,
		  $HADOOP_HOME/share/hadoop/hdfs/*,
		  $HADOOP_HOME/share/hadoop/hdfs/lib/*,
		  $HADOOP_HOME/share/hadoop/mapreduce/*,
		  $HADOOP_HOME/share/hadoop/mapreduce/lib/*,
		  $HADOOP_HOME/share/hadoop/yarn/*,
		  $HADOOP_HOME/share/hadoop/yarn/lib/*
		</value>
	</property>
	<property>
		<name>yarn.log-aggregation-enable</name>
		<value>true</value>
	</property>
	<property>
		<name>yarn.nodemanager.remote-app-log-dir</name>
		<value>/tmp/logs</value>  <!-- 或 HDFS 上的 path: hdfs://localhost:9000/tmp/logs -->
	</property>
</configuration>
```

---

##### zoo.cfg

复制默认配置：

```bash
cd /usr/local/zookeeper/conf
cp zoo_sample.cfg zoo.cfg
```

编辑 `zoo.cfg`：
可以直接全部替换，或者找到对应项来替换：

```ini
tickTime=2000
dataDir=/usr/local/zookeeper/data
dataLogDir=/usr/local/zookeeper/logs
clientPort=2181
initLimit=10
syncLimit=5
```

创建目录：

```bash
sudo mkdir -p /usr/local/zookeeper/data
sudo mkdir -p /usr/local/zookeeper/logs
```

##### hbase-env.sh

添加语句
```bash
export JAVA_HOME=/usr/local/java/jdk1.8.0_461
export HBASE_MANAGES_ZK=false   # 因为我们自己启动了独立的 ZooKeeper
export HBASE_DISABLE_HADOOP_CLASSPATH_LOOKUP=true
```

##### hbase-site.xml

```xml
<configuration>
    <!-- 使用 HDFS 存储 HBase 数据 -->
    <property>
        <name>hbase.rootdir</name>
        <value>hdfs://localhost:9000/hbase</value>
    </property>

    <!-- 表示这是一个分布式集群（即便是伪分布式） -->
    <property>
        <name>hbase.cluster.distributed</name>
        <value>true</value>
    </property>

    <!-- ZooKeeper 配置 -->
    <property>
        <name>hbase.zookeeper.quorum</name>
        <value>localhost</value>
    </property>
    <property>
        <name>hbase.zookeeper.property.clientPort</name>
        <value>2181</value>
    </property>
    <property>
    <name>hbase.master.hostname</name>
    <value>kxg-vm</value>
    </property>
</configuration>
```



---

##### 启动顺序总结

1. 启动 Hadoop（HDFS + YARN）

   ```bash
   hdfs namenode -format  # 这句是用于初始化NameNode的，在第一次启动前进行格式化。
   start-dfs.sh
   start-yarn.sh
   ```
   
   Web UI：
   
   * NameNode: [http://localhost:9870](http://localhost:9870)
   * YARN: [http://localhost:8088](http://localhost:8088)
   
2. 启动 ZooKeeper

   ```bash
   zkServer.sh start
   ```
   
   如果看到 `Mode: standalone`，说明启动成功。
   
3. 启动 HBase

   ```bash
   start-hbase.sh
   ```

---

3. **启动流程**
   ```bash
   # 启动HDFS
   start-dfs.sh
   # 启动YARN
   start-yarn.sh
   # 启动ZooKeeper
   zkServer.sh start
   # 启动HBase
   start-hbase.sh
   ```

<div style="page-break-after: always;"></div>

#### 2.3.3 完全分布环境搭建

![image-20250912151025653](https://raw.githubusercontent.com/SunJianBai/pictures/main/img/202509152024024.png)

##### 前期准备

在每台机器上都要做的事：

* 确保系统时间同步（推荐安装 chrony/ntp）。
* 安装相同版本的 JDK（1.8），并把 `JAVA_HOME` 设置到相同路径（例如 `/usr/local/java/jdk1.8.0_461`）。
* 把 Hadoop/HBase/ZooKeeper 的安装包解压到相同路径（例如 `/usr/local/hadoop`、`/usr/local/hbase`、`/usr/local/zookeeper`）。（下面有一次性复制命令）
* 创建用于运行 Hadoop/HBase 的同名用户（可选但推荐统一，例如 `sun`），并在三台上使用同一用户进行操作。
* 打开并启动 SSH 服务（每台都要）：
  ```bash
  sudo apt update
  sudo apt install -y openssh-server
  sudo systemctl enable ssh
  sudo systemctl start ssh
  ```

把三台的 IP 与主机名都写入每台的 `/etc/hosts`，例如（在 master、worker1、worker2 、worker3 四台都做相同修改）

虚拟机需要使用桥接模式，并连接到手机热点。

```
192.168.43.76 master
192.168.43.3 worker1
192.168.43.57 worker2
192.168.43.90 worker3
```

保存后测试：

```bash
ping -c 1 master
ping -c 1 worker1
ping -c 1 worker2
ping -c 1 worker3
```

##### SSH 无密码登录（在 master 上执行）

在 master 上生成密钥并分发到所有节点（包括自己）：

![img](https://raw.githubusercontent.com/SunJianBai/pictures/main/img/202509152018037.png)

这里的user写的是目标机器的用户名

```bash
# 在 master 上
ssh-keygen -t rsa -N "" -f ~/.ssh/id_rsa
ssh-copy-id -i ~/.ssh/id_rsa.pub user@master
ssh-copy-id -i ~/.ssh/id_rsa.pub user@worker1
ssh-copy-id -i ~/.ssh/id_rsa.pub user@worker2
ssh-copy-id -i ~/.ssh/id_rsa.pub user@worker3
# 测试
ssh sun@worker1
ssh sun@worker2
ssh sun@worker3
```

`sun` 是你实际的登录用户名,集群的每台机器用户名需要相同。如果能免密登录，则 OK。

##### Hadoop 配置改动 (从伪分布修改为完全分布)

在 master（或本地配置机）编辑并准备好这些配置文件，然后分发到 worker 上（用 scp）。

关键文件位置：`$HADOOP_HOME/etc/hadoop/`

要修改的文件及内容（把 `localhost` 换成 `master` 或实际主机名）：

**core-site.xml**

```xml
<configuration>
  <property>
    <name>fs.defaultFS</name>
    <value>hdfs://master:9000</value>
  </property>
  <property>
    <name>hadoop.tmp.dir</name>
    <value>/usr/local/hadoop/tmp</value>
  </property>
</configuration>
```

**hdfs-site.xml**

```xml
<configuration>
  <property>
    <name>dfs.replication</name>
    <value>3</value> <!-- 三个节点，副本数设为3 -->
  </property>
  <property>
    <name>dfs.namenode.name.dir</name>
    <value>file:///usr/local/hadoop/hdfs/namenode</value>
  </property>
  <property>
    <name>dfs.datanode.data.dir</name>
    <value>file:///usr/local/hadoop/hdfs/datanode</value>
  </property>
</configuration>
```

在每台机器上 `dfs.namenode.name.dir` / `dfs.datanode.data.dir` 
**yarn-site.xml**

```xml
<?xml version="1.0"?>
<configuration>
  <property>
    <name>yarn.nodemanager.aux-services</name>
    <value>mapreduce_shuffle</value>
  </property>
  <property>
    <name>yarn.resourcemanager.hostname</name>
    <value>master</value>
  </property>
  <property>
		<name>yarn.application.classpath</name>
		<value>
		  $HADOOP_HOME/etc/hadoop,
		  $HADOOP_HOME/share/hadoop/common/*,
		  $HADOOP_HOME/share/hadoop/common/lib/*,
		  $HADOOP_HOME/share/hadoop/hdfs/*,
		  $HADOOP_HOME/share/hadoop/hdfs/lib/*,
		  $HADOOP_HOME/share/hadoop/mapreduce/*,
		  $HADOOP_HOME/share/hadoop/mapreduce/lib/*,
		  $HADOOP_HOME/share/hadoop/yarn/*,
		  $HADOOP_HOME/share/hadoop/yarn/lib/*
		</value>
	</property>
	<property>
		<name>yarn.log-aggregation-enable</name>
		<value>true</value>
	</property>
	<property>
		<name>yarn.nodemanager.remote-app-log-dir</name>
		<value>/tmp/logs</value>  <!-- 或 HDFS 上的 path: hdfs://localhost:9000/tmp/logs -->
	</property>
</configuration>

```

mapred-site.xml

```xml
<configuration>
  <property>
    <name>mapreduce.framework.name</name>
    <value>yarn</value>
  </property>
</configuration>
```

workers

在 `$HADOOP_HOME/etc/hadoop/workers` 写上 worker 主机名（每行一个）：

```
master
worker1
worker2
worker3
```

这样 `start-dfs.sh` / `start-yarn.sh` 会在这些主机上启动 DataNode / NodeManager。

##### ZooKeeper 配置（每台都要改并创建 myid）

我们的完全分布有四个节点，但是只有三个运行了zookeeper。

在 `$ZOOKEEPER_HOME/conf/zoo.cfg`（在三台机器上放相同文件）：

```properties
tickTime=2000
dataDir=/usr/local/zookeeper/data
dataLogDir=/usr/local/zookeeper/logs
clientPort=2181
initLimit=10
syncLimit=5
server.1=master:2888:3888
server.2=worker1:2888:3888
server.3=worker2:2888:3888
server.4=worker3:2888:3888
```

在每台机器创建 dataDir 并写 myid（数字对应上面 server.N）：

```bash
# 在 master
mkdir -p /usr/local/zookeeper/data /usr/local/zookeeper/logs
echo "1" > /usr/local/zookeeper/data/myid

# 在 worker1
ssh sun@worker1 "mkdir -p /usr/local/zookeeper/data /usr/local/zookeeper/logs; echo '2' > /usr/local/zookeeper/data/myid"

# 在 worker2
ssh sun@worker2 "mkdir -p /usr/local/zookeeper/data /usr/local/zookeeper/logs; echo '3' > /usr/local/zookeeper/data/myid"

# 在 worker3
ssh sun@worker3 "mkdir -p /usr/local/zookeeper/data /usr/local/zookeeper/logs; echo '4' > /usr/local/zookeeper/data/myid"
```

##### HBase 配置改动（修改 hbase-site.xml）

在 `$HBASE_HOME/conf/hbase-site.xml`（把 `localhost` 改成集群主机名并分发）：

```xml
<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="configuration.xsl"?>
<configuration>
  <!-- 使用 HDFS 存储 HBase 数据 -->
  <property>
    <name>hbase.rootdir</name>
    <value>hdfs://master:9000/hbase</value>
  </property>

  <!-- 表示这是一个分布式集群（即便是伪分布式） -->
  <property>
    <name>hbase.cluster.distributed</name>
    <value>true</value>
  </property>

  <!-- ZooKeeper 配置 -->
  <property>
    <name>hbase.zookeeper.quorum</name>
    <value>master,worker1,worker2</value>
  </property>
  
  <property>
    <name>hbase.zookeeper.property.clientPort</name>
    <value>2181</value>
  </property>
</configuration>
```

hbase-env.sh 设置 Java 与不由 HBase 管理 ZooKeeper：

```bash
export JAVA_HOME=/usr/local/java/jdk1.8.0_461
export HBASE_MANAGES_ZK=false
```

在 `$HBASE_HOME/conf/regionservers` 写上 regionserver 主机名（每行一个，不需要写master）：

```
worker1
worker2
```

---

## 2.4 算法及实现

### 2.4.1 原理介绍

  如下图所示，client提交MapReduce作业，JobTracker将作业分成多个任务Task，交由多个TaskTracker并行执行任务。对于每个任务，分为MapTask和ReduceTask，MapTask将每个文件中的句子分为多个键值对<k, v>。map后得到的键值对进行排序，将相同key的键值对存储在相同的块中。ReduceTask将键值对进行合并操作，并存储到HBase中。

  对于Map任务的数量，取决于文件的大小，在环形缓存区溢写后即分配一个map任务。在分配map任务时，要考虑数据本地化（Data Local），即分配给含有该map任务的数据块中的TaskTracker中。对于Reduce任务的数量，可以在配置文件或程序中进行设置，ReduceTaskTracker根据key的HashCode对ReducerNum取余数的值分配，一个reducetask对应一个partition（分区）。

![img](data:image/jpeg;base64,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)

  在本次实验中，我们分别继承了Mapper类和Reducer类并重写了map、reduce函数，统计了每个单词在每个文件中出现的次数，具体算法过程如下。

### 2.4.2 build.gradle 配置

**设计说明**：
 该 `build.gradle` 文件配置了 Java 项目所需的依赖和构建规则。

- 使用 `mavenCentral()` 作为仓库，能够自动下载 Hadoop 与 HBase 的依赖库。
- 依赖部分引入了 Hadoop 核心组件、客户端接口，以及 HBase 的常用组件和 MapReduce 集成包。
- `application` 与 `jar` 部分确保生成的 JAR 包包含正确的主类信息 (`Main-Class`)，并打包运行时依赖，方便在分布式环境中直接运行。

```json
plugins {
    id 'java'
    id 'application'
}

group = 'com.test'
version = '1.2-Localhost'
sourceCompatibility = '1.8'
targetCompatibility = '1.8'

repositories {
    mavenCentral()
}

dependencies {
    implementation 'org.apache.hadoop:hadoop-common:3.3.5'
    implementation 'org.apache.hadoop:hadoop-client:3.3.5'
    implementation 'org.apache.hbase:hbase-common:2.5.4'
    implementation 'org.apache.hbase:hbase-client:2.5.4'
    implementation 'org.apache.hbase:hbase-mapreduce:2.5.4'
}

application {
    mainClass = 'com.test.Driver'
}

jar {
    manifest {
        attributes 'Main-Class': 'com.test.Driver'
    }
    from {
        configurations.runtimeClasspath.collect { it.isDirectory() ? it : zipTree(it) }
    }
    duplicatesStrategy = DuplicatesStrategy.EXCLUDE
}
```

### 2.4.3 Map阶段实现

`InvertedIndexMapper`类继承自`Mapper<LongWritable, Text, Text, Text>`，其中`Mapper`是Hadoop中的核心类，用于将输入数据映射为键值对。它实现了`map()`方法，处理输入数据并生成中间结果，供后续的Reducer处理。

**设计说明**：

- **输入数据**：
  每一行包含一个编号和若干单词，格式如：`1 word1 word2 word3`。
  - `LongWritable key`：表示行号或文件偏移量，在本实现中未被使用。
  - `Text value`：表示文件中的一行文本数据。
- **处理逻辑**：
  1. 将每一行按空格分割，忽略首列编号，仅保留单词序列。
  2. 通过 `FileSplit` 获取输入文件的文件名，以便在倒排索引中区分不同来源文件。
  3. 遍历每个单词，构造键值对 `<word:filename, 1>`。
- **输出结果**：
  - key：`word:filename`，用于标记单词在哪个文件中出现。
  - value：`1`，表示出现了一次。

**算法核心**

**`map()` 方法**：

- **输入**：
  - `key`：行号（LongWritable类型），在这段代码中没有使用。
  - `value`：表示一行输入文本（Text类型）。
  - `context`：提供了与Hadoop框架通信的上下文，允许Mapper将结果输出。
- **处理过程**：
  - **拆分行文本**：使用 `value.toString().split(" ")` 将输入的文本行按空格拆分为一个单词数组。拆分后的第一个元素（句子编号）被忽略，后续的元素是句子中的单词。
  - **获取文件名**：通过 `FileSplit` 获取当前处理的输入文件名，这个文件名会与每个单词组合在一起，用作键的一部分。
  - **构建键值对**：通过遍历句子中的每个单词，将单词与文件名组合（格式为 `word:filename`），然后将该组合作为键，"1" 作为值（代表该单词在该文件中出现过一次），并输出到 `context` 中。

```java
package com.sun;

import org.apache.hadoop.io.LongWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapreduce.Mapper;
import org.apache.hadoop.mapreduce.lib.input.FileSplit;

import java.io.IOException;
import java.util.Arrays;


/**
 * Mapper 负责将每行输入转换为 (word:file, 1) 形式的中间键值对。
 *
 * 设计说明：
 * - 输入假定为每行以空格分隔，第一列可能是句子编号或其它元信息，后续为句子中的单词集合
 * - Map 输出的 key 使用 "word:filename" 格式，value 初始为字符串 "1"，表示该单词在该句子中出现一次
 * - 这样做的好处是：Combiner 可以在 map 端聚合同一文件内该词的出现次数，从而显著减少要传输给 Reducer 的数据量
 */
public class InvertedMapper extends Mapper<LongWritable, Text, Text, Text>
{
    // keyInfo 存储 "word:filename"，valueInfo 初始为 "1"
    private final Text keyInfo = new Text();
    private final Text valueInfo = new Text("1");

    @Override
    protected void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException
    {
        // 把整行按空格拆分。第一部分可能是句子编号，后续为单词
        String[] orderedSentences = value.toString().split(" ");

        // 获取当前输入分片对应的文件名，便于构建 file-level 索引
        FileSplit filesplit = (FileSplit) context.getInputSplit();
        String filename = filesplit.getPath().getName();

        // 从第二列开始是句子的单词（按代码原逻辑）
        String[] sentences = Arrays.copyOfRange(orderedSentences, 1, orderedSentences.length);

        // 对句子内每个单词输出 <word:filename, 1>
        // 这样 Combiner/Reducer 可以按 word 聚合并输出 file:count
        for (String word : sentences)
        {
            keyInfo.set(word + ":" + filename);
            context.write(keyInfo, valueInfo);
        }
    }
}
```

### 2.4.4 Combine阶段实现

`InvertedIndexCombiner`类继承自`Reducer<Text, Text, Text, Text>`：它实现了`reduce()`方法，将Mapper生成的中间结果进行局部聚合。输入键值对为`<Text, Text>`，输出的键值对也是`<Text, Text>`。

- **Mapper阶段的输出**：在Mapper阶段，每行文本被处理后，生成的键值对是`<word:filename, 1>`，表示某个单词在某个文件中出现了一次。对于同一个文件中的同一个单词，可能会产生多个键值对，如：
  ```
  <word1:file1, 1>
  <word1:file1, 1>
  <word2:file1, 1>
  ```

- **Combiner阶段的优化**：Combiner相当于一个局部的Reducer，它的作用是对Mapper输出的结果进行局部合并，减少数据传输量。在`InvertedIndexCombiner`中，它负责计算出同一文件中某个单词的总出现次数，并将结果重新格式化为`<单词, 文件名:次数>`的形式。例如：
  ```
  Mapper 输出: <word1:file1, 1>, <word1:file1, 1>
  Combiner 输出: <word1, file1:2>
  ```
  这样，在Reducer阶段传输的数据量大大减少，从而一定程度提高了性能。

**设计说明**：

- **输入数据**：
  Mapper 输出的中间结果 `<word:filename, 1>`。同一个文件的相同单词会出现多次。
- **处理逻辑**：
  1. 遍历所有值 `"1"`，累加得到该单词在文件中的总出现次数。
  2. 将原始 key（`word:filename`）拆分为单词和文件名。
  3. 输出新的键值对 `<word, filename:count>`。
- **输出结果**：
  - key：单词（如 `word1`）
  - value：文件名和出现次数（如 `file1:3`）
- **作用**：
  Combiner 是 **局部 Reducer**，它在 Map 阶段本地执行，能够有效减少需要传输到真正 Reducer 的数据量，提升整体性能。

```java
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapreduce.Reducer;
import java.io.IOException;

/**
 * 倒排索引Combiner类
 * 在Map端进行局部聚合，减少网络传输数据量
 * 输入: 〈单词:文件名, [1, 1, ...]〉
 * 输出: 〈单词, 文件名:频次〉
 */
public class InvertedIndexCombiner extends Reducer<Text, Text, Text, Text> {
    private Text result = new Text();
    
    @Override
    protected void reduce(Text key, Iterable<Text> values, Context context) 
            throws IOException, InterruptedException {
        int sum = 0;
        for (Text val : values) {
            sum += Integer.parseInt(val.toString());
        }
        
        String[] parts = key.toString().split(":");
        if (parts.length < 2) return;
        
        String word = parts[0];
        String document = parts[1];
        
        result.set(document + ":" + sum);
        context.write(new Text(word), result);
    }
}
```

### 2.4.5 Reduce阶段实现

`InvertedIndexReducer`类继承自`TableReducer<Text, Text, ImmutableBytesWritable>`。用于将输入的key和values进行处理，并将结果输出到HBase表中。

**设计说明**：

- **输入数据**：
  Combiner 的输出 `<word, filename:count>`。同一个单词可能对应多个不同文件。
- **处理逻辑**：
  1. 将所有 `filename:count` 拼接为以分号分隔的字符串，例如：`file1:3;file2:5;file3:1;`。
  2. 使用单词作为行键（rowkey），构建 HBase 的 `Put` 对象。
  3. 将结果存储到 HBase 表的 `info:index` 列中。
- **输出结果**：
  - HBase 表中一行数据：
    - rowkey = 单词
    - 列族 = `info`
    - 列名 = `index`
    - 值 = `filename:count;filename2:count2;...`
- **作用**：
  最终得到倒排索引表，实现从单词到文件集合的映射。借助 HBase，可以直接进行分布式查询，满足大规模文本检索需求。

```java
import org.apache.hadoop.hbase.client.Put;
import org.apache.hadoop.hbase.io.ImmutableBytesWritable;
import org.apache.hadoop.hbase.mapreduce.TableReducer;
import org.apache.hadoop.hbase.util.Bytes;
import org.apache.hadoop.io.Text;
import java.io.IOException;

/**
 * 倒排索引Reducer类
 * 将结果直接写入HBase表
 * 输入: 〈单词, [文件名1:频次1, 文件名2:频次2, ...]〉
 * 输出: HBase表中的行
 */
public class InvertedIndexReducer extends TableReducer<Text, Text, ImmutableBytesWritable> {
    
    @Override
    protected void reduce(Text key, Iterable<Text> values, Context context) 
            throws IOException, InterruptedException {
        StringBuilder documents = new StringBuilder();
        
        for (Text value : values) {
            if (documents.length() > 0) {
                documents.append(";");
            }
            documents.append(value.toString());
        }
        
        // 创建HBase Put对象，RowKey为单词
        Put put = new Put(Bytes.toBytes(key.toString()));
        // 将文档列表存入info:documents列
        put.addColumn(
            Bytes.toBytes("info"), 
            Bytes.toBytes("documents"), 
            Bytes.toBytes(documents.toString())
        );
        
        context.write(null, put);
    }
}
```

### 2.4.6 Driver主程序

`InvertedIndexDriver`作为Hadoop MapReduce的驱动程序，负责配置和启动作业。其核心任务是使用`InvertedIndexMapper`、`InvertedIndexCombiner`和`InvertedIndexReducer`来处理HDFS中的数据，并将结果写入HBase表中。

**设计说明**：

- **核心职责**：作为整个 MapReduce 作业的入口，配置并启动任务。
- **配置内容**：
  - `fs.defaultFS`：HDFS 的 NameNode 地址。
  - `yarn.resourcemanager.hostname`：YARN 的资源调度管理节点。
  - `hbase.zookeeper.quorum`：HBase 使用的 ZooKeeper 集群地址。
- **作业设置**：
  - Mapper → `InvertedMapper` ：指定作业的 Mapper 类，负责将输入数据拆分并生成键值对。
  - Combiner → `InvertedCombiner` ：指定作业的 Combiner 类，用于在 Mapper 输出后，Reducer 之前对数据进行本地聚合。
  - Reducer → `InvertedReducer` ：指定 Reducer 类，用于最终的聚合和结果输出。
  - 输入路径通过命令行参数传递，保持通用性。
- **输出结果**：
  使用 `TableMapReduceUtil` 直接将 Reducer 的结果写入 HBase 表 `InvertedIndexTable`，作业的输出不是写入 HDFS 文件系统，而是直接插入到 HBase 表中。通过这种方式，避免额外的导入步骤，提升性能和易用性。

```java
package com.sun;

import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.fs.Path;
import org.apache.hadoop.hbase.mapreduce.TableMapReduceUtil;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapreduce.Job;
import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;

import java.io.IOException;

/**
 * Driver 程序：MapReduce 作业入口。
 *
 * 设计说明：
 * - 该类负责组装并提交一个 Hadoop MapReduce 作业：设置 Mapper/Combiner/Reducer、输入路径、以及 HBase 输出表
 * - 将 Reducer 配置为 TableReducer 可直接写入 HBase，从而避免额外的导入步骤（性能与工程便利性）
 * - 在 Configuration 中显式设置 fs.defaultFS、yarn.resourcemanager.hostname、hbase.zookeeper.quorum，
 *   这使得该驱动能够在不同环境（本地伪分布或真实集群）之间更容易切换，不依赖于外部 shell 环境变量
 */
public class Driver {
    public static void main(String[] args) throws ClassNotFoundException, IOException,InterruptedException {
        Configuration conf = new Configuration();
        // HDFS NameNode 地址——明确写出可以避免依赖外部环境变量而导致的连接错误
        conf.set("fs.defaultFS","hdfs://master:9000");
        // YARN ResourceManager 地址
        conf.set("yarn.resourcemanager.hostname","master");
        // HBase 的 ZooKeeper quorum，Reducer 会直接向 HBase 写入结果
        conf.set("hbase.zookeeper.quorum","master,worker1,worker2,worker3");

        // 创建并配置 Job
        Job job = Job.getInstance(conf);
        job.setJarByClass(Driver.class);
        job.setMapperClass(InvertedMapper.class);
        // Combiner 做本地合并以减少网络传输（对计数类问题安全有效）
        job.setCombinerClass(InvertedCombiner.class);
        // Reducer 使用 TableReducer 写入 HBase
        job.setReducerClass(InvertedReducer.class);
        job.setMapOutputKeyClass(Text.class);
        job.setMapOutputValueClass(Text.class);

        // 调整 reduce shuffle 内存占比以避免 OOM（示例参数，可根据集群调优）
        job.getConfiguration().setStrings("mapreduce.reduce.shuffle.memory.limit.percent", "0.15");

        // 输入路径从命令行读取，保持通用性
        FileInputFormat.setInputPaths(job,new Path(args[0]));
        // 将 Reducer 初始化为写入 HBase 的 TableReducer，表名请根据实际修改
        TableMapReduceUtil.initTableReducerJob("InvertedIndexTable",InvertedReducer.class,job);
        boolean res = job.waitForCompletion(true);
        System.exit(res?0:1);
    }
}
```

---

<div style="page-break-after: always;"></div>

## 2.5 全流程运行

### 2.5.1 启动环境

（在 master 上操作，依赖 SSH 能免密登录）

先格式化 NameNode（只做一次，master 上）：

```bash
hdfs namenode -format
```

启动 ZooKeeper 集群（在每台或通过 ssh 远程）：

```bash
# 从 master 开启所有 zk
ssh user@master  "zkServer.sh start"
ssh user@worker1 "zkServer.sh start"
ssh user@worker2 "zkServer.sh start"

# 验证
ssh user@master  "zkServer.sh status"
ssh user@worker1 "zkServer.sh status"
ssh user@worker2 "zkServer.sh status"
```

启动 HDFS + YARN（从 master）：

```bash
# 这会通过 ssh 到 workers 启动 DataNode/NodeManager
start-dfs.sh
start-yarn.sh
```

检查每台机器 `jps`，应看到：

* master: NameNode, ResourceManager, SecondaryNameNode(if any), HMaster, QuorumPeerMain
* worker1/worker2: DataNode, NodeManager, HRegionServer, QuorumPeerMain

![image-20250912150331865](https://raw.githubusercontent.com/SunJianBai/pictures/main/img/202509152024215.png)

![image-20250912150414350](https://raw.githubusercontent.com/SunJianBai/pictures/main/img/202509152024379.png)

![img](03.png)

HDFS NameNode UI: `http://master:9870`

可以看到四台机器的datanode节点：
![image-20250912201345126](https://raw.githubusercontent.com/SunJianBai/pictures/main/img/202509152021012.png)

进入YARN UI验证是否启动成功: `http://master:8088`

![image-20250912151058398](https://raw.githubusercontent.com/SunJianBai/pictures/main/img/202509152024556.png)

启动 HBase（master）：

```bash
start-hbase.sh
```


验证 HBase Master UI： `http://master:16010`![image-20250912151002258](https://raw.githubusercontent.com/SunJianBai/pictures/main/img/202509152024987.png)



### 2.5.2 分割文件

解压sentence压缩包获得其中sentence.txt，将其按照每一万行句子进行划分，并将划分好的940个文件命名为files0~files939

```python
import os
import math
import logging
# 用于处理老师发的文件
# 这个脚本用于将一个大的txt文件按每10000行分割成多个小文件
# 指定输入文件和输出目录
input_file_path = r"./data/sentences/sentences.txt"  # 输入的txt文件路径
output_directory = r'./data/sentences/files'  # 指定的输出目录路径
logging.basicConfig(level=logging.INFO)
logging.info('Starting file splitting')
# 打开原始txt文件,一共有9397023条句子
with open(input_file_path, 'r', encoding='utf-8') as input_file:
    lines = input_file.readlines()
# 计算总行数和文件数
total_lines = len(lines)
num_files = (total_lines + 9999) // 10000
# 分割文件
for i in range(num_files):
    logging.info(f'Processing file {i + 1}/{num_files}')
    start = i * 10000
    end = min((i + 1) * 10000, total_lines)
    output_filename = os.path.join(output_directory, f'file{i}.txt')

    # 写入分割后的内容到新文件
    with open(output_filename, 'w', encoding='utf-8') as output_file:
        output_file.writelines(lines[start:end])
```

![image-20250912160346685](https://raw.githubusercontent.com/SunJianBai/pictures/main/img/202509152024384.png)

### 2.5.3 上传文件

把分割好的940个文件存入hdfs，副本数为3.

![image-20250913192321852](https://raw.githubusercontent.com/SunJianBai/pictures/main/img/202509152025405.png)

可以在HDFS的web ui界面看到上传的文件

![image-20250914102039376](https://raw.githubusercontent.com/SunJianBai/pictures/main/img/202509152025946.png)

存完可以看到存入的文件大小

![image-20250913192407901](https://raw.githubusercontent.com/SunJianBai/pictures/main/img/202509152025921.png)

### 2.5.4 运行MapReduce

构建编译之前的MapReduce代码，可以获得一个 jar 包。通过命令行让hadoop运行jar包来执行MapReduce

其中jar包的名字根据实际运行情况来填写，具体名字取决于构建脚本 `build.gradle`中 `version`字段

```bash
hadoop jar build/libs/InvertedMapReduce-1.0-SNAPSHOT.jar /input/sentences/files
```

跑完MapReduce后会把处理结果存入Hbase数据库中

![image-20250916143540658](https://raw.githubusercontent.com/SunJianBai/pictures/main/img/202509161435810.png)

## 2.6 运行结果

### 2.6.1四机器完全分布

运行用时34分钟

![image-20250913192452973](https://raw.githubusercontent.com/SunJianBai/pictures/main/img/202509152026446.png)

### 2.6.2 单机伪分布

耗时15分钟

![image-20250914105259161](https://raw.githubusercontent.com/SunJianBai/pictures/main/img/202509152026223.png)

### 2.6.3 运行结果分析

由于数据量只有**1.3GB** ，所以体现不出完全分布的优势，单机伪分布下没有网络传输，所有 map 和 reduce 都在本地磁盘 I/O 内完成，速度比完全分布更快。

在分布式环境下，**JobTracker / ResourceManager** 要分配任务，**TaskTracker / NodeManager** 要启动 JVM 容器，过程中有大量心跳、RPC 调度、日志收集等操作。

每个 map/reduce task 在远程节点启动时都会有 **网络传输 + 任务启动开销**。

对于 900+ 小文件来说，map task 数量很多，启动/调度的开销可能比实际计算时间还大。



## 2.7 验证结果

### 2.7.1 查看数据库

在 `Hbase shell` 里查看 `InvertedIndexTable` 表内的数据，可以看到 `MapReduce` 成功获取到了每个单词出现的文档内容和次数。

![image-20250913192815106](https://raw.githubusercontent.com/SunJianBai/pictures/main/img/202509152026944.png)



### 2.7.2 调用查询工具

在命令行使用用于查询数据库的jar包来查询结果

![image-20250913192912421](https://raw.githubusercontent.com/SunJianBai/pictures/main/img/202509152031371.png)

### 2.7.3 使用web ui

使用web ui可视化查询

![image-20250913193030509](https://raw.githubusercontent.com/SunJianBai/pictures/main/img/202509152030359.png)

![image-20250913193011958](https://raw.githubusercontent.com/SunJianBai/pictures/main/img/202509152030473.png)

![image-20250913193018256](https://raw.githubusercontent.com/SunJianBai/pictures/main/img/202509152030146.png)





# 3. 故障排查







#  4. 总结

通过本项目实践，我们成功实现了基于Hadoop生态系统的分布式倒排索引系统，达到了预期目标。主要成果包括：

1. **技术成果**
   - 掌握了Hadoop集群的搭建和配置技术
   - 实现了基于MapReduce的倒排索引算法
   - 完成了HBase数据库的设计和数据存储
   - 实现了分布式环境下的数据处理和存储

2. **实践收获**
   - 深入理解了分布式计算原理和MapReduce编程模型
   - 学会了大数据系统的性能优化和调试技巧
   - 掌握了团队协作开发大数据项目的方法
   - 积累了处理实际大数据问题的经验

3. **项目亮点**
   - 完整的系统架构设计，涵盖数据预处理、处理、存储和查询全流程
   - 优化了Combiner阶段，显著减少网络传输数据量
   - 实现了完全分布式环境下的高效处理
   - 提供了详细的技术文档和实现说明

4. **改进方向**
   - 可以进一步优化数据分区策略，提高并行处理效率
   - 可以考虑引入更复杂的分词和文本处理算法
   - 可以开发Web前端界面，提供更友好的查询体验
   - 可以探索实时索引更新机制，支持增量数据处理

本项目为我们后续的大数据学习和研究奠定了坚实基础，积累了宝贵的实践经验。

## 参考文献

1. White, T. (2015). *Hadoop: The Definitive Guide*. O'Reilly Media.
2. Apache Hadoop官方文档. https://hadoop.apache.org/
3. Apache HBase官方文档. https://hbase.apache.org/


## 附录

### 附录A：项目GitHub仓库

本项目代码已开源在GitHub：https://github.com/SunJianBai/Hadoop-SUN

仓库包含：
- 完整的MapReduce源代码
- 环境配置脚本和文档
- 测试数据集和处理脚本
- 项目报告和演示材料

### 附录B：关键配置文件和脚本

#### Hadoop环境变量配置 (~/.bashrc)
```bash
export JAVA_HOME=/usr/local/java/jdk1.8.0_461
export HADOOP_HOME=/usr/local/hadoop
export HBASE_HOME=/usr/local/hbase
export ZOOKEEPER_HOME=/usr/local/zookeeper
export PATH=$PATH:$JAVA_HOME/bin:$HADOOP_HOME/bin:$HADOOP_HOME/sbin:$HBASE_HOME/bin:$ZOOKEEPER_HOME/bin
```

#### MapReduce项目构建

```bash
cd java_src/InvertedMapReduce
./gradlew build
```

### 附录C：测试数据和结果样例

#### 输入数据样例 (sentences.txt片段)
```
0 This is the first sentence
1 Hadoop is a big data framework
2 MapReduce is a programming model
...
```

#### 输出结果样例 (HBase inverted_index表)
```
RowKey: hadoop
info:documents -> file23:15;file156:12;file342:8;...

RowKey: mapreduce  
info:documents -> file45:10;file189:7;file567:5;...
```

